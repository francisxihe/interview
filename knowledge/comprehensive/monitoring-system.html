<!DOCTYPE html>
<html lang="en-US" dir="ltr">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>如果让你来实现一个前端监控系统，应该考虑什么？如何去实现？ | Interview Questions</title>
    <meta name="description" content="Interview Questions">
    <meta name="generator" content="VitePress v1.0.0-rc.36">
    <link rel="preload stylesheet" href="/interview/assets/style.mP64b32S.css" as="style">
    
    <script type="module" src="/interview/assets/app.gFhLTJjb.js"></script>
    <link rel="preload" href="/interview/assets/inter-roman-latin.bvIUbFQP.woff2" as="font" type="font/woff2" crossorigin="">
    <link rel="modulepreload" href="/interview/assets/chunks/framework.RtLYYSF3.js">
    <link rel="modulepreload" href="/interview/assets/chunks/theme.M3q-5Da2.js">
    <link rel="modulepreload" href="/interview/assets/knowledge_comprehensive_monitoring-system.md.eMqky53T.lean.js">
    <script id="check-dark-mode">(()=>{const e=localStorage.getItem("vitepress-theme-appearance")||"auto",a=window.matchMedia("(prefers-color-scheme: dark)").matches;(!e||e==="auto"?a:e==="dark")&&document.documentElement.classList.add("dark")})();</script>
    <script id="check-mac-os">document.documentElement.classList.toggle("mac",/Mac|iPhone|iPod|iPad/i.test(navigator.platform));</script>
  </head>
  <body>
    <div id="app"><div class="Layout" data-v-4d8a3d05><!--[--><!--]--><!--[--><span tabindex="-1" data-v-28ff4bf2></span><a href="#VPContent" class="VPSkipLink visually-hidden" data-v-28ff4bf2> Skip to content </a><!--]--><!----><header class="VPNav" data-v-4d8a3d05 data-v-9ae418e8><div class="VPNavBar has-sidebar" data-v-9ae418e8 data-v-175c3ffa><div class="wrapper" data-v-175c3ffa><div class="container" data-v-175c3ffa><div class="title" data-v-175c3ffa><div class="VPNavBarTitle has-sidebar" data-v-175c3ffa data-v-3791bdfa><a class="title" href="/interview/" data-v-3791bdfa><!--[--><!--]--><!----><!--[-->Interview Questions<!--]--><!--[--><!--]--></a></div></div><div class="content" data-v-175c3ffa><div class="content-body" data-v-175c3ffa><!--[--><!--]--><div class="VPNavBarSearch search" data-v-175c3ffa><!--[--><!----><div id="local-search"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg class="DocSearch-Search-Icon" width="20" height="20" viewBox="0 0 20 20" aria-label="search icon"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"><kbd class="DocSearch-Button-Key"></kbd><kbd class="DocSearch-Button-Key">K</kbd></span></button></div><!--]--></div><nav aria-labelledby="main-nav-aria-label" class="VPNavBarMenu menu" data-v-175c3ffa data-v-2161a920><span id="main-nav-aria-label" class="visually-hidden" data-v-2161a920>Main Navigation</span><!--[--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/interview/" tabindex="0" data-v-2161a920 data-v-3e01f209><!--[--><span data-v-3e01f209>Home</span><!--]--></a><!--]--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/interview/knowledge/" tabindex="0" data-v-2161a920 data-v-3e01f209><!--[--><span data-v-3e01f209>八股文</span><!--]--></a><!--]--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/interview/programming-tests/" tabindex="0" data-v-2161a920 data-v-3e01f209><!--[--><span data-v-3e01f209>编程</span><!--]--></a><!--]--><!--]--></nav><!----><div class="VPNavBarAppearance appearance" data-v-175c3ffa data-v-1d66bc43><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" title="Switch to dark theme" aria-checked="false" data-v-1d66bc43 data-v-447745c5 data-v-dafd5002><span class="check" data-v-dafd5002><span class="icon" data-v-dafd5002><!--[--><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="sun" data-v-447745c5><path d="M12,18c-3.3,0-6-2.7-6-6s2.7-6,6-6s6,2.7,6,6S15.3,18,12,18zM12,8c-2.2,0-4,1.8-4,4c0,2.2,1.8,4,4,4c2.2,0,4-1.8,4-4C16,9.8,14.2,8,12,8z"></path><path d="M12,4c-0.6,0-1-0.4-1-1V1c0-0.6,0.4-1,1-1s1,0.4,1,1v2C13,3.6,12.6,4,12,4z"></path><path d="M12,24c-0.6,0-1-0.4-1-1v-2c0-0.6,0.4-1,1-1s1,0.4,1,1v2C13,23.6,12.6,24,12,24z"></path><path d="M5.6,6.6c-0.3,0-0.5-0.1-0.7-0.3L3.5,4.9c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l1.4,1.4c0.4,0.4,0.4,1,0,1.4C6.2,6.5,5.9,6.6,5.6,6.6z"></path><path d="M19.8,20.8c-0.3,0-0.5-0.1-0.7-0.3l-1.4-1.4c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l1.4,1.4c0.4,0.4,0.4,1,0,1.4C20.3,20.7,20,20.8,19.8,20.8z"></path><path d="M3,13H1c-0.6,0-1-0.4-1-1s0.4-1,1-1h2c0.6,0,1,0.4,1,1S3.6,13,3,13z"></path><path d="M23,13h-2c-0.6,0-1-0.4-1-1s0.4-1,1-1h2c0.6,0,1,0.4,1,1S23.6,13,23,13z"></path><path d="M4.2,20.8c-0.3,0-0.5-0.1-0.7-0.3c-0.4-0.4-0.4-1,0-1.4l1.4-1.4c0.4-0.4,1-0.4,1.4,0s0.4,1,0,1.4l-1.4,1.4C4.7,20.7,4.5,20.8,4.2,20.8z"></path><path d="M18.4,6.6c-0.3,0-0.5-0.1-0.7-0.3c-0.4-0.4-0.4-1,0-1.4l1.4-1.4c0.4-0.4,1-0.4,1.4,0s0.4,1,0,1.4l-1.4,1.4C18.9,6.5,18.6,6.6,18.4,6.6z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="moon" data-v-447745c5><path d="M12.1,22c-0.3,0-0.6,0-0.9,0c-5.5-0.5-9.5-5.4-9-10.9c0.4-4.8,4.2-8.6,9-9c0.4,0,0.8,0.2,1,0.5c0.2,0.3,0.2,0.8-0.1,1.1c-2,2.7-1.4,6.4,1.3,8.4c2.1,1.6,5,1.6,7.1,0c0.3-0.2,0.7-0.3,1.1-0.1c0.3,0.2,0.5,0.6,0.5,1c-0.2,2.7-1.5,5.1-3.6,6.8C16.6,21.2,14.4,22,12.1,22zM9.3,4.4c-2.9,1-5,3.6-5.2,6.8c-0.4,4.4,2.8,8.3,7.2,8.7c2.1,0.2,4.2-0.4,5.8-1.8c1.1-0.9,1.9-2.1,2.4-3.4c-2.5,0.9-5.3,0.5-7.5-1.1C9.2,11.4,8.1,7.7,9.3,4.4z"></path></svg><!--]--></span></span></button></div><div class="VPSocialLinks VPNavBarSocialLinks social-links" data-v-175c3ffa data-v-2be199e9 data-v-1e6c418a><!--[--><a class="VPSocialLink no-icon" href="https://github.com/vuejs/vitepress" aria-label="github" target="_blank" rel="noopener" data-v-1e6c418a data-v-9ab428d4><svg role="img" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><title>GitHub</title><path d="M12 .297c-6.63 0-12 5.373-12 12 0 5.303 3.438 9.8 8.205 11.385.6.113.82-.258.82-.577 0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.305 3.495.998.108-.776.417-1.305.76-1.605-2.665-.3-5.466-1.332-5.466-5.93 0-1.31.465-2.38 1.235-3.22-.135-.303-.54-1.523.105-3.176 0 0 1.005-.322 3.3 1.23.96-.267 1.98-.399 3-.405 1.02.006 2.04.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.653.24 2.873.12 3.176.765.84 1.23 1.91 1.23 3.22 0 4.61-2.805 5.625-5.475 5.92.42.36.81 1.096.81 2.22 0 1.606-.015 2.896-.015 3.286 0 .315.21.69.825.57C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12"/></svg></a><!--]--></div><div class="VPFlyout VPNavBarExtra extra" data-v-175c3ffa data-v-0a9695cd data-v-a40b65a2><button type="button" class="button" aria-haspopup="true" aria-expanded="false" aria-label="extra navigation" data-v-a40b65a2><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="icon" data-v-a40b65a2><circle cx="12" cy="12" r="2"></circle><circle cx="19" cy="12" r="2"></circle><circle cx="5" cy="12" r="2"></circle></svg></button><div class="menu" data-v-a40b65a2><div class="VPMenu" data-v-a40b65a2 data-v-43465531><!----><!--[--><!--[--><!----><div class="group" data-v-0a9695cd><div class="item appearance" data-v-0a9695cd><p class="label" data-v-0a9695cd>Appearance</p><div class="appearance-action" data-v-0a9695cd><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" title="Switch to dark theme" aria-checked="false" data-v-0a9695cd data-v-447745c5 data-v-dafd5002><span class="check" data-v-dafd5002><span class="icon" data-v-dafd5002><!--[--><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="sun" data-v-447745c5><path d="M12,18c-3.3,0-6-2.7-6-6s2.7-6,6-6s6,2.7,6,6S15.3,18,12,18zM12,8c-2.2,0-4,1.8-4,4c0,2.2,1.8,4,4,4c2.2,0,4-1.8,4-4C16,9.8,14.2,8,12,8z"></path><path d="M12,4c-0.6,0-1-0.4-1-1V1c0-0.6,0.4-1,1-1s1,0.4,1,1v2C13,3.6,12.6,4,12,4z"></path><path d="M12,24c-0.6,0-1-0.4-1-1v-2c0-0.6,0.4-1,1-1s1,0.4,1,1v2C13,23.6,12.6,24,12,24z"></path><path d="M5.6,6.6c-0.3,0-0.5-0.1-0.7-0.3L3.5,4.9c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l1.4,1.4c0.4,0.4,0.4,1,0,1.4C6.2,6.5,5.9,6.6,5.6,6.6z"></path><path d="M19.8,20.8c-0.3,0-0.5-0.1-0.7-0.3l-1.4-1.4c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l1.4,1.4c0.4,0.4,0.4,1,0,1.4C20.3,20.7,20,20.8,19.8,20.8z"></path><path d="M3,13H1c-0.6,0-1-0.4-1-1s0.4-1,1-1h2c0.6,0,1,0.4,1,1S3.6,13,3,13z"></path><path d="M23,13h-2c-0.6,0-1-0.4-1-1s0.4-1,1-1h2c0.6,0,1,0.4,1,1S23.6,13,23,13z"></path><path d="M4.2,20.8c-0.3,0-0.5-0.1-0.7-0.3c-0.4-0.4-0.4-1,0-1.4l1.4-1.4c0.4-0.4,1-0.4,1.4,0s0.4,1,0,1.4l-1.4,1.4C4.7,20.7,4.5,20.8,4.2,20.8z"></path><path d="M18.4,6.6c-0.3,0-0.5-0.1-0.7-0.3c-0.4-0.4-0.4-1,0-1.4l1.4-1.4c0.4-0.4,1-0.4,1.4,0s0.4,1,0,1.4l-1.4,1.4C18.9,6.5,18.6,6.6,18.4,6.6z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="moon" data-v-447745c5><path d="M12.1,22c-0.3,0-0.6,0-0.9,0c-5.5-0.5-9.5-5.4-9-10.9c0.4-4.8,4.2-8.6,9-9c0.4,0,0.8,0.2,1,0.5c0.2,0.3,0.2,0.8-0.1,1.1c-2,2.7-1.4,6.4,1.3,8.4c2.1,1.6,5,1.6,7.1,0c0.3-0.2,0.7-0.3,1.1-0.1c0.3,0.2,0.5,0.6,0.5,1c-0.2,2.7-1.5,5.1-3.6,6.8C16.6,21.2,14.4,22,12.1,22zM9.3,4.4c-2.9,1-5,3.6-5.2,6.8c-0.4,4.4,2.8,8.3,7.2,8.7c2.1,0.2,4.2-0.4,5.8-1.8c1.1-0.9,1.9-2.1,2.4-3.4c-2.5,0.9-5.3,0.5-7.5-1.1C9.2,11.4,8.1,7.7,9.3,4.4z"></path></svg><!--]--></span></span></button></div></div></div><div class="group" data-v-0a9695cd><div class="item social-links" data-v-0a9695cd><div class="VPSocialLinks social-links-list" data-v-0a9695cd data-v-1e6c418a><!--[--><a class="VPSocialLink no-icon" href="https://github.com/vuejs/vitepress" aria-label="github" target="_blank" rel="noopener" data-v-1e6c418a data-v-9ab428d4><svg role="img" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><title>GitHub</title><path d="M12 .297c-6.63 0-12 5.373-12 12 0 5.303 3.438 9.8 8.205 11.385.6.113.82-.258.82-.577 0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.305 3.495.998.108-.776.417-1.305.76-1.605-2.665-.3-5.466-1.332-5.466-5.93 0-1.31.465-2.38 1.235-3.22-.135-.303-.54-1.523.105-3.176 0 0 1.005-.322 3.3 1.23.96-.267 1.98-.399 3-.405 1.02.006 2.04.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.653.24 2.873.12 3.176.765.84 1.23 1.91 1.23 3.22 0 4.61-2.805 5.625-5.475 5.92.42.36.81 1.096.81 2.22 0 1.606-.015 2.896-.015 3.286 0 .315.21.69.825.57C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12"/></svg></a><!--]--></div></div></div><!--]--><!--]--></div></div></div><!--[--><!--]--><button type="button" class="VPNavBarHamburger hamburger" aria-label="mobile navigation" aria-expanded="false" aria-controls="VPNavScreen" data-v-175c3ffa data-v-556d422d><span class="container" data-v-556d422d><span class="top" data-v-556d422d></span><span class="middle" data-v-556d422d></span><span class="bottom" data-v-556d422d></span></span></button></div></div></div></div><div class="divider" data-v-175c3ffa><div class="divider-line" data-v-175c3ffa></div></div></div><!----></header><div class="VPLocalNav has-sidebar empty" data-v-4d8a3d05 data-v-74e19326><div class="container" data-v-74e19326><button class="menu" aria-expanded="false" aria-controls="VPSidebarNav" data-v-74e19326><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="menu-icon" data-v-74e19326><path d="M17,11H3c-0.6,0-1-0.4-1-1s0.4-1,1-1h14c0.6,0,1,0.4,1,1S17.6,11,17,11z"></path><path d="M21,7H3C2.4,7,2,6.6,2,6s0.4-1,1-1h18c0.6,0,1,0.4,1,1S21.6,7,21,7z"></path><path d="M21,15H3c-0.6,0-1-0.4-1-1s0.4-1,1-1h18c0.6,0,1,0.4,1,1S21.6,15,21,15z"></path><path d="M17,19H3c-0.6,0-1-0.4-1-1s0.4-1,1-1h14c0.6,0,1,0.4,1,1S17.6,19,17,19z"></path></svg><span class="menu-text" data-v-74e19326>Menu</span></button><div class="VPLocalNavOutlineDropdown" style="--vp-vh:0px;" data-v-74e19326 data-v-16ba06d7><button data-v-16ba06d7>Return to top</button><!----></div></div></div><aside class="VPSidebar" data-v-4d8a3d05 data-v-8af53b0c><div class="curtain" data-v-8af53b0c></div><nav class="nav" id="VPSidebarNav" aria-labelledby="sidebar-aria-label" tabindex="-1" data-v-8af53b0c><span class="visually-hidden" id="sidebar-aria-label" data-v-8af53b0c> Sidebar Navigation </span><!--[--><!--]--><!--[--><div class="group" data-v-8af53b0c><section class="VPSidebarItem level-0 collapsible is-link" data-v-8af53b0c data-v-d55e92e7><div class="item" tabindex="0" data-v-d55e92e7><div class="indicator" data-v-d55e92e7></div><a class="VPLink link link" href="/interview/knowledge/web/" data-v-d55e92e7><!--[--><h2 class="text" data-v-d55e92e7>web</h2><!--]--></a><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-d55e92e7><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="caret-icon" data-v-d55e92e7><path d="M9,19c-0.3,0-0.5-0.1-0.7-0.3c-0.4-0.4-0.4-1,0-1.4l5.3-5.3L8.3,6.7c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l6,6c0.4,0.4,0.4,1,0,1.4l-6,6C9.5,18.9,9.3,19,9,19z"></path></svg></div></div><div class="items" data-v-d55e92e7><!--[--><div class="VPSidebarItem level-1 is-link" data-v-d55e92e7 data-v-d55e92e7><div class="item" data-v-d55e92e7><div class="indicator" data-v-d55e92e7></div><a class="VPLink link link" href="/interview/knowledge/web/html/" data-v-d55e92e7><!--[--><p class="text" data-v-d55e92e7>html</p><!--]--></a><!----></div><!----></div><section class="VPSidebarItem level-1 is-link" data-v-d55e92e7 data-v-d55e92e7><div class="item" tabindex="0" data-v-d55e92e7><div class="indicator" data-v-d55e92e7></div><a class="VPLink link link" href="/interview/knowledge/web/javascript/" data-v-d55e92e7><!--[--><h3 class="text" data-v-d55e92e7>javascript</h3><!--]--></a><!----></div><div class="items" data-v-d55e92e7><!--[--><div class="VPSidebarItem level-2 is-link" data-v-d55e92e7 data-v-d55e92e7><div class="item" data-v-d55e92e7><div class="indicator" data-v-d55e92e7></div><a class="VPLink link link" href="/interview/knowledge/web/javascript/proxy.html" data-v-d55e92e7><!--[--><p class="text" data-v-d55e92e7>proxy</p><!--]--></a><!----></div><!----></div><!--]--></div></section><!--]--></div></section></div><div class="group" data-v-8af53b0c><section class="VPSidebarItem level-0" data-v-8af53b0c data-v-d55e92e7><div class="item" role="button" tabindex="0" data-v-d55e92e7><div class="indicator" data-v-d55e92e7></div><h2 class="text" data-v-d55e92e7>框架工具</h2><!----></div><div class="items" data-v-d55e92e7><!--[--><div class="VPSidebarItem level-1 is-link" data-v-d55e92e7 data-v-d55e92e7><div class="item" data-v-d55e92e7><div class="indicator" data-v-d55e92e7></div><a class="VPLink link link" href="/interview/knowledge/framework/Vue/" data-v-d55e92e7><!--[--><p class="text" data-v-d55e92e7>Vue</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-d55e92e7 data-v-d55e92e7><div class="item" data-v-d55e92e7><div class="indicator" data-v-d55e92e7></div><a class="VPLink link link" href="/interview/knowledge/framework/webpack/" data-v-d55e92e7><!--[--><p class="text" data-v-d55e92e7>webpack</p><!--]--></a><!----></div><!----></div><section class="VPSidebarItem level-1 is-link" data-v-d55e92e7 data-v-d55e92e7><div class="item" tabindex="0" data-v-d55e92e7><div class="indicator" data-v-d55e92e7></div><a class="VPLink link link" href="/interview/knowledge/framework/Diff算法/" data-v-d55e92e7><!--[--><h3 class="text" data-v-d55e92e7>Diff算法</h3><!--]--></a><!----></div><div class="items" data-v-d55e92e7><!--[--><div class="VPSidebarItem level-2 is-link" data-v-d55e92e7 data-v-d55e92e7><div class="item" data-v-d55e92e7><div class="indicator" data-v-d55e92e7></div><a class="VPLink link link" href="/interview/knowledge/framework/Diff%E7%AE%97%E6%B3%95/vue2.html" data-v-d55e92e7><!--[--><p class="text" data-v-d55e92e7>vue2</p><!--]--></a><!----></div><!----></div><!--]--></div></section><!--]--></div></section></div><div class="group" data-v-8af53b0c><section class="VPSidebarItem level-0 is-link" data-v-8af53b0c data-v-d55e92e7><div class="item" tabindex="0" data-v-d55e92e7><div class="indicator" data-v-d55e92e7></div><a class="VPLink link link" href="/interview/knowledge/programming-paradigm/" data-v-d55e92e7><!--[--><h2 class="text" data-v-d55e92e7>编程范式</h2><!--]--></a><!----></div><div class="items" data-v-d55e92e7><!--[--><div class="VPSidebarItem level-1 is-link" data-v-d55e92e7 data-v-d55e92e7><div class="item" data-v-d55e92e7><div class="indicator" data-v-d55e92e7></div><a class="VPLink link link" href="/interview/knowledge/programming-paradigm/functional-programming.html" data-v-d55e92e7><!--[--><p class="text" data-v-d55e92e7>函数式编程</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><div class="group" data-v-8af53b0c><div class="VPSidebarItem level-0 is-link" data-v-8af53b0c data-v-d55e92e7><div class="item" tabindex="0" data-v-d55e92e7><div class="indicator" data-v-d55e92e7></div><a class="VPLink link link" href="/interview/knowledge/design-pattern/" data-v-d55e92e7><!--[--><p class="text" data-v-d55e92e7>设计模式</p><!--]--></a><!----></div><!----></div></div><!--]--><!--[--><!--]--></nav></aside><div class="VPContent has-sidebar" id="VPContent" data-v-4d8a3d05 data-v-35c0c801><div class="VPDoc has-sidebar has-aside" data-v-35c0c801 data-v-e906f36f><!--[--><!--]--><div class="container" data-v-e906f36f><div class="aside" data-v-e906f36f><div class="aside-curtain" data-v-e906f36f></div><div class="aside-container" data-v-e906f36f><div class="aside-content" data-v-e906f36f><div class="VPDocAside" data-v-e906f36f data-v-24266b9e><!--[--><!--]--><!--[--><!--]--><div class="VPDocAsideOutline" role="navigation" data-v-24266b9e data-v-9cdf9c98><div class="content" data-v-9cdf9c98><div class="outline-marker" data-v-9cdf9c98></div><div class="outline-title" role="heading" aria-level="2" data-v-9cdf9c98>导航</div><nav aria-labelledby="doc-outline-aria-label" data-v-9cdf9c98><span class="visually-hidden" id="doc-outline-aria-label" data-v-9cdf9c98> Table of Contents for current page </span><ul class="VPDocOutlineItem root" data-v-9cdf9c98 data-v-e82e81d8><!--[--><!--]--></ul></nav></div></div><!--[--><!--]--><div class="spacer" data-v-24266b9e></div><!--[--><!--]--><!----><!--[--><!--]--><!--[--><!--]--></div></div></div></div><div class="content" data-v-e906f36f><div class="content-container" data-v-e906f36f><!--[--><!--]--><main class="main" data-v-e906f36f><div style="position:relative;" class="vp-doc _interview_knowledge_comprehensive_monitoring-system" data-v-e906f36f><div><h1 id="如果让你来实现一个前端监控系统-应该考虑什么-如何去实现" tabindex="-1">如果让你来实现一个前端监控系统，应该考虑什么？如何去实现？ <a class="header-anchor" href="#如果让你来实现一个前端监控系统-应该考虑什么-如何去实现" aria-label="Permalink to &quot;如果让你来实现一个前端监控系统，应该考虑什么？如何去实现？&quot;">​</a></h1><h2 id="_1-为什么要做前端监控" tabindex="-1">1. 为什么要做前端监控 <a class="header-anchor" href="#_1-为什么要做前端监控" aria-label="Permalink to &quot;1. 为什么要做前端监控&quot;">​</a></h2><p>更快的发现问题 做产品决策依据 提升前端开发的技术深度和广度 为业务扩展提供更多可能性</p><h2 id="_2-前端数据分类" tabindex="-1">2. 前端数据分类 <a class="header-anchor" href="#_2-前端数据分类" aria-label="Permalink to &quot;2. 前端数据分类&quot;">​</a></h2><p>前端的数据其实有很多，从大众普遍关注的 PV、UV、广告点击量，到客户端的网络环境、登陆状态，再到浏览器、操作系统信息，最后到页面性能、JS 异常，这些数据都可以在前端收集到。</p><h3 id="_2-1-访问相关的数据" tabindex="-1">2.1 访问相关的数据 <a class="header-anchor" href="#_2-1-访问相关的数据" aria-label="Permalink to &quot;2.1 访问相关的数据&quot;">​</a></h3><p>PV/UV:最基础的 PV(页面访问量)、UV(独立访问用户数据量) 页面来源：页面的 referer,可以定位页面的入口 操作系统：了解用户的 OS 情况，帮助分析用户群体的特征，特别是移动端、iOS 和 Android 的分布就更有意义了 浏览器：可以统计到各种浏览器的占比，对于是否继续兼容 IE6、新技术(HTML5、CSS3 等)的运用等调研提供参考价值 分辨率：对页面设计提供参考，特别是响应式设计 登录率：登陆用户具有更高的分析价值，引导用户登陆是非常重要的 地域分布：访问用户在地理位置上的分布，可以针对不同地域做运营、活动等 网络类型：wifi/3G/2G，为产品是否需要适配不同网络环境做决策 访问时段：掌握用户访问时间的分布，引导消峰填谷、节省带宽 停留时长：判断页面内容是否具有吸引力，对于需要长时间阅读的页面比较有意义 到达深度：和停留时长类似，例如百度百科，用户浏览时的页面到达深度直接反映词条的质量</p><h3 id="_2-2-性能相关的数据" tabindex="-1">2.2 性能相关的数据 <a class="header-anchor" href="#_2-2-性能相关的数据" aria-label="Permalink to &quot;2.2 性能相关的数据&quot;">​</a></h3><p>白屏时间：用户从打开页面开始到页面开始有东西呈现为止，这过程中占用的时间就是白屏时间 首屏时间：用户浏览器首屏内所有内容都呈现出来所花费的时间 用户可操作时间：用户可以进行正常的点击、输入等操作 页面总下载时间：页面所有资源都加载完成并呈现出来所花的时间，即页面 onload 的时间 自定义的时间点：对于开发人员来说，完全可以自定义一些时间点，例如：某个组件 init 完成的时间、某个重要模块加载的时间等等</p><h3 id="_2-3-点击相关的数据" tabindex="-1">2.3 点击相关的数据 <a class="header-anchor" href="#_2-3-点击相关的数据" aria-label="Permalink to &quot;2.3 点击相关的数据&quot;">​</a></h3><p>页面总点击量 人均点击量：对于导航类的网页，这项指标是非常重要的 流出 url：同样，导航类的网页，直接了解网页导流的去向 点击时间：用户的所有点击行为，在时间上的分布，反映了用户点击操作的习惯 首次点击时间：同上，但是只统计用户的第一次点击，如果该时间偏大，是否就表明页面很卡导致用户长时间不能点击呢？ 点击热力图：根据用户点击的位置，我们可以画出整个页面的点击热力图，可以很直观的了解到页面的热点区域</p><h3 id="_2-4-异常相关的数据" tabindex="-1">2.4 异常相关的数据 <a class="header-anchor" href="#_2-4-异常相关的数据" aria-label="Permalink to &quot;2.4 异常相关的数据&quot;">​</a></h3><p>这里的异常是指 JS 的异常，用户的浏览器上报 JS 的 bug，这会极大地降低用户体验</p><p>异常的提示信息：这是识别一个异常的最重要依据，如：e.src 为空或不是对象 JS 文件名 异常所在行 发生异常的浏览器 堆栈信息：必要的时候需要函数调用的堆栈信息，但是注意堆栈信息可能会比较大，需要截取</p><h3 id="_2-5-其它数据" tabindex="-1">2.5 其它数据 <a class="header-anchor" href="#_2-5-其它数据" aria-label="Permalink to &quot;2.5 其它数据&quot;">​</a></h3><p>除了上面提到的 4 类基本的数据统计需求，我们当然还可以根据实际情况来定义一些其他的统计需求，如用户浏览器对 canvas 的支持程度， 再比如比较特殊的-用户进行轮播图翻页的次数，这些数据统计需求都是前端能够满足的，每一项统计的结果都体现了前端数据的价值</p><h2 id="_3-性能指标" tabindex="-1">3.性能指标 <a class="header-anchor" href="#_3-性能指标" aria-label="Permalink to &quot;3.性能指标&quot;">​</a></h2><p>FP(First Paint)：首次绘制时间，包括了任何用户自定义的背景绘制，它是首先将像素绘制到屏幕的时刻。 FCP(First Content Paint)：首次内容绘制。是浏览器将第一个 DOM 渲染到屏幕的时间，可能是文本、图像、SVG 等。这其实就是白屏时间 FMP(First Meaningful Paint)：首次有意义绘制。页面有意义的内容渲染的时间 LCP(Largest Contentful Paint)。最大内容渲染。代表在 viewport 中最大的页面元素加载的时间。 DCL(DomContentLoaded)：DOM 加载完成。当 HTML 文档被完全加载和解析完成之后，DOMContentLoaded 事件被触发。无需等待样式表，图像和子框架的完成加载。 L(onload)：当依赖的资源全部加载完毕之后才会触发。 TTI(Time to Interactive)：可交互时间。用于标记应用已进行视觉渲染并能可靠响应用户输入的时间点。 FID(First Input Delay)：首次输入延迟。用户首次和页面交互(单击链接、点击按钮等)到页面响应交互的时间。</p><h2 id="_4-前端监控目标-监控分类" tabindex="-1">4.前端监控目标(监控分类) <a class="header-anchor" href="#_4-前端监控目标-监控分类" aria-label="Permalink to &quot;4.前端监控目标(监控分类)&quot;">​</a></h2><h3 id="_4-1-稳定性-stability" tabindex="-1">4.1 稳定性(stability) <a class="header-anchor" href="#_4-1-稳定性-stability" aria-label="Permalink to &quot;4.1 稳定性(stability)&quot;">​</a></h3><p>JS 错误，JS 执行错误或者 Promise 异常 资源异常，script、link 等资源加载异常 接口错误,ajax 或 fetch 请求接口异常 白屏，页面空白</p><h3 id="_4-2-用户体验-experience" tabindex="-1">4.2 用户体验(experience) <a class="header-anchor" href="#_4-2-用户体验-experience" aria-label="Permalink to &quot;4.2 用户体验(experience)&quot;">​</a></h3><p>加载时间，各个阶段的加载时间 TTFB(Time To First Byte 首字节时间)。是指浏览器发起第一个请求到数据返回第一个字节所消耗的时间，这个时间包含了网络请求时间、后端处理时间。 FP(First Paint 首次绘制)。首次绘制包括了任何用户自定义的背景绘制，它是将第一个像素点绘制到屏幕的时间。 FCP(First Content Paint 首次内容绘制)。首次内容绘制是浏览器将第一个 DOM 渲染到屏幕的时间，可以是任何文本、图像、SVG 等的时间。 FMP(First Meaningful Paint 首次有意义绘制)。 首次有意义绘制是页面可用性的量度标准。 FID(First Input Delay 首次输入延迟)。用户首次和页面交互到页面响应交互的时间。 卡顿。 超过 50ms 的任务。</p><h3 id="_4-3-业务" tabindex="-1">4.3 业务 <a class="header-anchor" href="#_4-3-业务" aria-label="Permalink to &quot;4.3 业务&quot;">​</a></h3><p>PV：page view 即页面浏览量或点击量 UV：指访问某个站点的不同 IP 地址的人数。 页面停留时间：用户在每一个页面的停留时间。</p><h3 id="_5-前端监控流程" tabindex="-1">5.前端监控流程 <a class="header-anchor" href="#_5-前端监控流程" aria-label="Permalink to &quot;5.前端监控流程&quot;">​</a></h3><p>数据埋点 数据上报 分析和计算，将采集到的数据进行加工总结 可视化展示，将数据按照各种维度进行展示 监控报警，发现问题后按一定的条件触发报警</p><h3 id="_6-常见的埋点方案" tabindex="-1">6.常见的埋点方案 <a class="header-anchor" href="#_6-常见的埋点方案" aria-label="Permalink to &quot;6.常见的埋点方案&quot;">​</a></h3><h3 id="_6-1-代码埋点" tabindex="-1">6.1 代码埋点 <a class="header-anchor" href="#_6-1-代码埋点" aria-label="Permalink to &quot;6.1 代码埋点&quot;">​</a></h3><p>代码埋点，就是以嵌入代码的形式进行埋点，比如要监控用户的点击事件，会选择在用户点击时插入一段代码，保存这个监听行为或者直接将监听行为 以某一种数据格式直接传递给服务器端。 优点是可以在任意时刻，精确的发送或保存所需要的数据信息。 缺点就是工作量大</p><h3 id="_6-2-可视化埋点" tabindex="-1">6.2 可视化埋点 <a class="header-anchor" href="#_6-2-可视化埋点" aria-label="Permalink to &quot;6.2 可视化埋点&quot;">​</a></h3><p>通过可视化交互的手段，代替代码埋点。 将业务代码和埋点代码分离，提供一个可视化交互的页面，输入为业务代码，通过这个可视化系统，可以在业务代码中自定义 的增加埋点事件等等。最后输出的代码耦合了业务代码和埋点代码 可视化埋点其实是用系统来代替手工插入埋点代码。</p><h3 id="_6-3-无痕埋点" tabindex="-1">6.3 无痕埋点 <a class="header-anchor" href="#_6-3-无痕埋点" aria-label="Permalink to &quot;6.3 无痕埋点&quot;">​</a></h3><p>前端的任意一个事件都被绑定一个标识，所有的事件都被记录下来。 通过定期上传记录文件，配合文件解析，解析出来我们想要的数据，并生成可视化报告供专业人员分析 无痕埋点的优点是采集全量数据，不会出现漏埋和误埋等现象 缺点是给数据传输和服务器增加压力，也无法灵活定制数据结构</p><h2 id="_7-编写监控采集脚本" tabindex="-1">7. 编写监控采集脚本 <a class="header-anchor" href="#_7-编写监控采集脚本" aria-label="Permalink to &quot;7. 编写监控采集脚本&quot;">​</a></h2><h3 id="_7-1-监控错误" tabindex="-1">7.1 监控错误 <a class="header-anchor" href="#_7-1-监控错误" aria-label="Permalink to &quot;7.1 监控错误&quot;">​</a></h3><p>错误分类 JS 错误 Promise 异常 资源异常 监听 error</p><h3 id="_7-2-数据结构设计" tabindex="-1">7.2 数据结构设计 <a class="header-anchor" href="#_7-2-数据结构设计" aria-label="Permalink to &quot;7.2 数据结构设计&quot;">​</a></h3><p>jsError</p><div class="language-js vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">let</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> info </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  title: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;前端监控系统&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 页面标题</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  url: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;http://localhost:8080&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 页面url</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  timestamp: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;1212121212121212&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 访问时间戳</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  userAgent: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;chrome&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 用户浏览器类型</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  kind: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;stability&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 大类</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  type: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;error&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 小类</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  errorType: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;jsError&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 错误类型</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  message: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;uncaught TypeError:blablabla&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 错误详情</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  filename: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;http://localhost:8080/&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 访问的文件名</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  position: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;0:0&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 行列信息</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  stack: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;btn Click (http://localhost:8080)&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 堆栈信息</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  selector: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;HTML BODY #container .content INPUT&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 选择器</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">};</span></span></code></pre></div><p>接口异常数据结构设置</p><div class="language-js vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">let</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> info </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  title: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;前端监控系统&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 页面标题</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  url: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;http://localhost:8080&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 页面url</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  timestamp: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;1212121212121212&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 访问时间戳</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  userAgent: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;chrome&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 用户浏览器类型</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  kind: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;stability&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 大类</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  type: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;xhr&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 小类</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  eventType: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;load&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 事件类型</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  pathname: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;/success&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  status: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;200-0k&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  duration: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;5&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 持续时间</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  response: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;hahah&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 响应内容</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  params: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;参数&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 参数</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">};</span></span></code></pre></div><p>白屏 screen 返回当前 window 的 screen 对象，返回当前渲染窗口中和屏幕有关的属性 innerWidth 只读的 window 属性。innerWidth 返回以像素为单位的窗口的内部宽度 innerHeight 窗口的内部高度(布局视口)的高度 layout_viewport elementsFromPoint 方法可以获取到当前视口内指定坐标处，由里到外排列的所有元素。</p><div class="language-js vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">let</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> info </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  title: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;前端监控系统&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  url: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;http://localhost:8080/&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  timestamp: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;1239404040404044&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  userAgent: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;chorme&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  kind: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;stability&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  type: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;blank&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  emptyPoints: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;0&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 空白点</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  screen: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;2049 * 1152&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 分辨率</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  viewPoint: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;2048 * 994&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 视口</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  selector: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;HTML BODY #container&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 选择器</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">};</span></span></code></pre></div><p>整体大致可以分四个阶段：信息采集、存储、分析、监控。</p><p>采集阶段：收集异常日志，先在本地做一定的处理，采取一定的方案上报到服务器。</p><p>存储阶段：后端接收前端上报的异常日志，经过一定处理，按照一定的存储方案存储。</p><p>分析阶段：分为机器自动分析和人工分析。机器自动分析，通过预设的条件和算法，对存储的日志信息进行统计和筛选，发现问题，触发报警。人工分析，通过提供一个可视化的数据面板，让系统用户可以看到具体的日志数据，根据信息，发现异常问题根源。</p><p>报警阶段：分为告警和预警。告警按照一定的级别自动报警，通过设定的渠道，按照一定的触发规则进行。预警则在异常发生前，提前预判，给出警告。</p><p>性能监控： 使用 Resource Timing API 和 Performance Timing API，可以计算许多重要的指标，比如页面性能统计的起始点时间、首屏时间等。</p><p>异常监控： 前端捕获异常分为全局捕获和局部捕获。局部捕获作为补充，对某些特殊情况进行捕获，但分散，不利于管理。所以，我会选择全局捕获的方式，即通过全局的接口，将捕获代码集中写在一个地方。具体在实现项目中，我应该会采用 badjs-report，它重写了 window.onerror 进行上报异常，无需编写任何捕获错误的代码。</p><p>前端埋点： 埋点的方案有手动埋点，即在需要监控的地方插入监控逻辑，但是工作量可能会很大；还有无埋点，前端自动采集全部事件，上报埋点数据，但是缺点是服务器压力会很大。我可能倾向于采用声明式埋点，将埋点代码和具体的业务逻辑解耦，只用关心需要埋点的控件，并且为这些控件声明需要的埋点数据即可，主要是为了降低埋点的成本吧。在 dom 元素上增添埋点信息，比如</p><div class="language-js vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// key 表示埋点的唯一标识；act 表示埋点方式</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">button</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> data-stat</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;{key:&#39;buttonKey&#39;, act: &#39;click&#39;}&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;埋点&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">button</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span></code></pre></div><p>监控告警： 这里我认为最便捷、高效的方式，就是接入内部的告警组了吧，尤其是在阿里，似乎什么轮子都有，那可能需要考虑就是触发告警的阈值和时机了。</p><p>性能：使用 Performance API，可以得到许多重要的指标，如页面性能统计的起始点时间、首屏时间等</p><p>报错：使用 onerror 和 onunhandledrejection，甚至是 try catch</p><p>操作行为：对事件触发函数做 patch，或者添加特定的事件监听</p><p>PV/UV：利用浏览器存储方法或 Cookie、IP 等储存相应用户信息，随请求发送</p><p>设备信息：获取 navigator.userAgent</p><p>PV、UV 属于增长数字类型，可以用 Redis 等记录，如果有需要，定时入库。其他属于大量文字信息，可以用成熟的消息队列来消费。因为有大量写，所以可以考虑做读写分离。</p><p>技术难点：</p><p>可能整个系统比较复杂的就是如何高效合理的进行监控数据上传。除了异常报错信息本身，还需要记录用户操作日志，如果任何日志都立即上报，这无异于自造的 DDOS 攻击。那就需要考虑前端日志的存储，日志如何上传，上传前如何整理日志等问题。</p><p>前端在收集的过程中可能会影响用户体验。</p><p>后端对于收到的日志要使用合适的工具进行收集，数据量大时选择如何取舍。</p><p>可能会采取的方案</p><p>indexDB 存储日志，因为容量大、异步！不用考虑阻塞页面问题。 在一个 webworker 中对日志进行整理，比如对每一条日志打上标签，进行分类等操作。 上报日志也在 webworker 中进行，可以按照重要紧急度区分，判断是否延时或者立即上报。</p></div></div></main><footer class="VPDocFooter" data-v-e906f36f data-v-9d2aa9e6><!--[--><!--]--><!----><nav class="prev-next" data-v-9d2aa9e6><div class="pager" data-v-9d2aa9e6><!----></div><div class="pager" data-v-9d2aa9e6><a class="VPLink link pager-link next" href="/interview/knowledge/web/" data-v-9d2aa9e6><!--[--><span class="desc" data-v-9d2aa9e6>Next page</span><span class="title" data-v-9d2aa9e6>web</span><!--]--></a></div></nav></footer><!--[--><!--]--></div></div></div><!--[--><!--]--></div></div><!----><!--[--><!--]--></div></div>
    <script>window.__VP_HASH_MAP__=JSON.parse("{\"knowledge_framework_webpack_plugin.md\":\"aMg9DxIB\",\"knowledge_framework_vite.md\":\"Z-3D2uuO\",\"knowledge_performance_白屏优化.md\":\"zgQh4zHs\",\"knowledge_framework_diff算法_vue3.md\":\"APQjMy_r\",\"knowledge_framework_vite_index.md\":\"ivcj76pK\",\"knowledge_framework_webpack_loader.md\":\"bgX2wX__\",\"programming-tests_index.md\":\"aGgbDnGH\",\"knowledge_performance_rail模型.md\":\"KeqiWcJa\",\"knowledge_performance_常见指标.md\":\"mzMioUoy\",\"knowledge_comprehensive_index.md\":\"UJSK25qt\",\"knowledge_index.md\":\"sLjQ-dwY\",\"knowledge_framework_diff算法_vue2.md\":\"fVia7Opt\",\"knowledge_programming-paradigm_index.md\":\"Zb5XUqZM\",\"knowledge_web_javascript_proxy.md\":\"1X7WKdlM\",\"knowledge_framework_vue_index.md\":\"DM0YZLKt\",\"knowledge_framework_qiankun_index.md\":\"I3PFHp9k\",\"index.md\":\"MD3CS2q-\",\"knowledge_programming-paradigm_functional-programming.md\":\"vIZngl9n\",\"knowledge_web_html_index.md\":\"KNR9_LQt\",\"knowledge_performance_javascript 动画和 css 动画该如果抉择.md\":\"FuG2Zopr\",\"knowledge_framework_react.md\":\"ZL5Vafsx\",\"knowledge_framework_webpack_index.md\":\"jzi86Ue7\",\"knowledge_design-pattern_index.md\":\"w0qFOBke\",\"knowledge_performance_cls 优化.md\":\"az903kkR\",\"programming-tests_javascript_curry.md\":\"v09y7eU9\",\"programming-tests_arithmetic_index.md\":\"F2jKxiNZ\",\"knowledge_framework_react 对比 vue.md\":\"GStG0PHt\",\"programming-tests_regular-expression_index.md\":\"7q0-gR1r\",\"programming-tests_javascript_publish-subscribe.md\":\"ms-SpCn7\",\"knowledge_web_index.md\":\"FfGCJ7kB\",\"knowledge_comprehensive_monitoring-system.md\":\"eMqky53T\",\"knowledge_framework_diff算法_index.md\":\"fmncatu9\",\"programming-tests_javascript_index.md\":\"Ou3WXLyG\"}");window.__VP_SITE_DATA__=JSON.parse("{\"lang\":\"en-US\",\"dir\":\"ltr\",\"title\":\"Interview Questions\",\"description\":\"Interview Questions\",\"base\":\"/interview/\",\"head\":[],\"router\":{\"prefetchLinks\":true},\"appearance\":true,\"themeConfig\":{\"outline\":{\"level\":[2,3],\"label\":\"导航\"},\"search\":{\"provider\":\"local\"},\"nav\":[{\"text\":\"Home\",\"link\":\"/\"},{\"text\":\"八股文\",\"link\":\"/knowledge/\"},{\"text\":\"编程\",\"link\":\"/programming-tests/\"}],\"sidebar\":{\"/knowledge\":[{\"text\":\"web\",\"collapsed\":false,\"link\":\"/knowledge/web/\",\"items\":[{\"text\":\"html\",\"link\":\"/knowledge/web/html/\"},{\"text\":\"javascript\",\"link\":\"/knowledge/web/javascript/\",\"items\":[{\"text\":\"proxy\",\"link\":\"/knowledge/web/javascript/proxy\"}]}]},{\"text\":\"框架工具\",\"items\":[{\"text\":\"Vue\",\"link\":\"/knowledge/framework/Vue/\"},{\"text\":\"webpack\",\"link\":\"/knowledge/framework/webpack/\"},{\"text\":\"Diff算法\",\"link\":\"/knowledge/framework/Diff算法/\",\"items\":[{\"text\":\"vue2\",\"link\":\"/knowledge/framework/Diff算法/vue2\"}]}]},{\"text\":\"编程范式\",\"link\":\"/knowledge/programming-paradigm/\",\"items\":[{\"text\":\"函数式编程\",\"link\":\"/knowledge/programming-paradigm/functional-programming\"}]},{\"text\":\"设计模式\",\"link\":\"/knowledge/design-pattern/\",\"items\":[]}],\"/programming-tests\":[{\"text\":\"编程\",\"items\":[{\"text\":\"javascript\",\"link\":\"/programming-tests/javascript/\",\"items\":[{\"text\":\"柯里化\",\"link\":\"/programming-tests/javascript/curry\"},{\"text\":\"发布订阅者模式\",\"link\":\"/programming-tests/javascript/publish-subscribe\"}]},{\"text\":\"算法\",\"link\":\"/programming-tests/arithmetic/\",\"items\":[]}]}]},\"socialLinks\":[{\"icon\":\"github\",\"link\":\"https://github.com/vuejs/vitepress\"}]},\"locales\":{},\"scrollOffset\":134,\"cleanUrls\":false}");</script>
    
  </body>
</html>